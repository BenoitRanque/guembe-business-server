(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["ceb776bc"],{"19d4":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("q-page",{attrs:{padding:""}},[a("q-table",{attrs:{flat:"",title:"Sitio Web",data:e.table.data,columns:e.table.columns,"row-key":"page_id",pagination:e.table.pagination,filter:e.table.filter,loading:e.table.loading},on:{"update:pagination":function(t){return e.$set(e.table,"pagination",t)},request:e.loadWebsite},scopedSlots:e._u([{key:"top-right",fn:function(){return[a("q-btn",{attrs:{color:"accent"},on:{click:function(t){e.showCreatePageDialog=!0}}},[e._v("\n        Crear pagina nueva\n      ")]),a("q-input",{attrs:{borderless:"",dense:"",debounce:"300",placeholder:"Buscar"},scopedSlots:e._u([{key:"append",fn:function(){return[a("q-icon",{attrs:{name:"mdi-magnify"}})]},proxy:!0}]),model:{value:e.table.filter,callback:function(t){e.$set(e.table,"filter",t)},expression:"table.filter"}})]},proxy:!0},{key:"body-cell-path",fn:function(t){return[a("q-td",{attrs:{props:t,"auto-width":""}},[a("q-btn",{attrs:{"no-wrap":"",flat:"",size:"sm","no-caps":"",label:"/"+t.row.path,"icon-right":"mdi-open-in-new"},on:{click:function(a){return e.$router.push("/website/preview/"+t.row.path)}}}),a("q-tooltip",[e._v("\n          Ver o modificar pagina\n        ")])],1)]}},{key:"body-cell-update",fn:function(t){return[a("q-td",{attrs:{props:t,"auto-width":""}},[a("q-btn",{attrs:{"no-wrap":"",flat:"",size:"sm",label:"Detalles","icon-right":"mdi-open-in-new"}}),a("q-tooltip",[e._v("\n          Ver o modificar pagina\n        ")])],1)]}}])}),a("q-inner-loading",{attrs:{showing:e.loading}},[a("q-spinner")],1),a("dialog-window",{attrs:{title:"Crear Pagina"},model:{value:e.showCreatePageDialog,callback:function(t){e.showCreatePageDialog=t},expression:"showCreatePageDialog"}},[a("create-page",{on:{done:function(t){return e.$router.push("/website/preview/"+t.path)}}})],1)],1)},n=[],o=a("967e"),r=a.n(o),s=a("02fa"),l=a.n(s),c=(a("96cf"),a("fa84")),d=a.n(c),m=a("7eb4"),u=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("q-form",{staticClass:"q-pa-md",on:{submit:e.submit,reset:e.reset}},[a("div",{staticClass:"q-gutter-y-md"},[a("q-input",{attrs:{filled:"",required:"",label:"Nombre",hint:"Nombre de uso interno","lazy-rules":"",rules:[]},model:{value:e.page.name,callback:function(t){e.$set(e.page,"name",t)},expression:"page.name"}}),a("q-input",{attrs:{filled:"",prefix:"/",label:"Ruta",hint:"Ruta donde se encontrara la pagina. Debe ser unica","lazy-rules":"",rules:[function(e){return!!/^([\w-]+(\/[\w-]+)*)?$/.test(e)||"Ruta invalida."}]},model:{value:e.page.path,callback:function(t){e.$set(e.page,"path",t)},expression:"page.path"}}),a("image-input",{attrs:{filled:"",format:"background",label:"Imagen de Fondo"},model:{value:e.page.image_id,callback:function(t){e.$set(e.page,"image_id",t)},expression:"page.image_id"}})],1),a("div",{staticClass:"row justify-around q-pa-md"},[a("q-btn",{attrs:{color:"secondary",flat:"",type:"reset"}},[e._v("reset")]),a("q-btn",{attrs:{color:"primary",type:"submit"}},[e._v("Crear")])],1),a("q-inner-loading",{attrs:{showing:e.loading}},[a("q-spinner")],1)],1)},p=[],g=a("f3e3"),f=a.n(g),h=(a("7f7f"),a("7aaf")),b={name:"CreatePage",components:{ImageInput:h["a"]},data:function(){return{loading:!1,options:{economic_activity:[]},page:{name:"",path:""}}},methods:{reset:function(){this.page.name="",this.page.path=""},submit:function(){this.$q.dialog({title:"Confirmar",message:"Este registro no puede modificicarse luego de la creacion",persistent:!0,cancel:!0}).onOk(this.createPage)},createPage:function(){var e=d()(r.a.mark(function e(){var t,a,i;return r.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,this.loading=!0,e.next=4,this.$store.dispatch("website/CREATE_PAGE",this.page);case 4:t=e.sent,a=f()(t.insert.page,1),i=a[0],this.$q.notify({icon:"mdi-check",color:"positive",message:"Pagina ".concat(i.name," Creada Exitosamente")}),this.$emit("done",i),e.next=14;break;case 11:e.prev=11,e.t0=e["catch"](0),this.$gql.handleError(e.t0);case 14:return e.prev=14,this.loading=!1,e.finish(14);case 17:case"end":return e.stop()}},e,this,[[0,11,14,17]])}));function t(){return e.apply(this,arguments)}return t}()}},w=b,_=a("2877"),v=Object(_["a"])(w,u,p,!1,null,null,null),q=v.exports,y=a("bd4c"),x=y["b"].formatDate,$={name:"Invoices",components:{DialogWindow:m["a"],CreatePage:q},data:function(){return{loading:!1,showCreatePageDialog:!1,table:{loading:!1,data:[],columns:[{name:"name",field:"name",label:"Nombre",align:"left"},{name:"path",field:"path",label:"Ruta",align:"left"},{name:"created_at",label:"Creado",align:"left",field:"created_at",format:function(e,t){return x(e,"YYYY/MM/DD HH:mm")}},{name:"created_by",label:"",align:"left",field:function(e){return e.created_by_user?e.created_by_user.username:null}},{name:"updated_at",label:"Modificado",align:"left",field:"updated_at",format:function(e,t){return x(e,"YYYY/MM/DD HH:mm")}},{name:"updated_by",label:"",align:"left",field:function(e){return e.updated_by_user?e.updated_by_user.username:null}},{name:"view"}],pagination:{sortBy:null,descending:!1,page:1,rowsPerPage:10,rowsNumber:0},filter:""}}},methods:{loadWebsite:function(){var e=d()(r.a.mark(function e(){var t,a,i,n,o,s,c,d,m,u=arguments;return r.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=u.length>0&&void 0!==u[0]?u[0]:{},a=t.pagination,i=t.filter,n=void 0===i?"":i,a||(a=this.table.pagination),o="query ($where: website_page_bool_exp! $offset: Int! $limit: Int! $order_by: [website_page_order_by!]) {\n        meta: website_page_aggregate (where: $where) {\n          rows: aggregate {\n            count\n          }\n        }\n        data: website_page (where: $where offset: $offset limit: $limit order_by: $order_by) {\n          page_id\n          name\n          path\n          created_at\n          created_by_user {\n            username\n          }\n          updated_at\n          updated_by_user {\n            username\n          }\n        }\n      }",s={limit:a.rowsPerPage,offset:a.rowsPerPage*(a.page-1),order_by:[{path:"asc"}],where:{_or:[{name:{_ilike:"%".concat(n,"%")}},{path:{_ilike:"%".concat(n,"%")}}]}},e.prev=4,this.table.loading=!0,e.next=8,this.$gql(o,s,{role:"administrator"});case 8:c=e.sent,d=c.data,m=c.meta.rows.count,this.table.pagination=l()({},a,{rowsNumber:m}),this.table.data=d,e.next=18;break;case 15:e.prev=15,e.t0=e["catch"](4),this.$gql.handleError(e.t0);case 18:return e.prev=18,this.table.loading=!1,e.finish(18);case 21:case"end":return e.stop()}},e,this,[[4,15,18,21]])}));function t(){return e.apply(this,arguments)}return t}()},mounted:function(){this.loadWebsite()}},I=$,z=Object(_["a"])(I,i,n,!1,null,null,null);t["default"]=z.exports},"4e53":function(e,t,a){var i=a("e916");"string"===typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);var n=a("499e").default;n("0d7b84c8",i,!1,{sourceMap:!1})},"5fa6":function(e,t,a){"use strict";var i=a("4e53"),n=a.n(i);n.a},"7aaf":function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("q-field",e._b({attrs:{value:e.value},on:{input:function(t){return e.$emit("input",t)}},nativeOn:{click:function(t){e.showImageSelectDialog=!0}},scopedSlots:e._u([{key:"prepend",fn:function(){return[a("q-avatar",{class:e.image?"cursor-pointer":"",attrs:{rounded:"",color:"grey-4"},on:{click:function(t){t.stopPropagation(),e.showImagePreviewDialog=!0}}},[e.image?a("q-img",{attrs:{src:e.$img.src(e.image.image_id,"xs"),placeholder:e.value.placeholder}}):e._e()],1)]},proxy:!0},{key:"control",fn:function(){return[a("div",{staticClass:"cursor-pointer col self-stretch row items-center"},[e._v("\n      "+e._s(e.image?e.image.name:null)+"\n    ")])]},proxy:!0},{key:"append",fn:function(){return[a("q-icon",{attrs:{name:"mdi-image-search"}},[a("q-tooltip",[e._v("\n        "+e._s(e.image?"Cambiar":"Seleccionar")+" Imagen\n      ")])],1)]},proxy:!0}])},"q-field",e.$attrs,!1),[a("dialog-window",{attrs:{title:"Selecionar Imagen"},model:{value:e.showImageSelectDialog,callback:function(t){e.showImageSelectDialog=t},expression:"showImageSelectDialog"}},[a("image-select",{attrs:{format:e.format},on:{done:e.imageSelected},scopedSlots:e._u([{key:"upload",fn:function(){return[a("q-btn",{staticClass:"q-mx-sm",attrs:{icon:"mdi-upload",dense:"",color:"accent"},on:{click:function(t){e.showImageUploadDialog=!0}}},[a("q-tooltip",[e._v("\n            Cargar Imagen Nueva\n          ")])],1)]},proxy:!0}])})],1),a("q-dialog",{attrs:{minimized:""},model:{value:e.showImageUploadDialog,callback:function(t){e.showImageUploadDialog=t},expression:"showImageUploadDialog"}},[a("q-card",[a("q-bar",[e._v("\n        Subir Imagen\n        "),a("q-space"),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",dense:"",icon:"mdi-close"}})],1),a("image-upload",{attrs:{format:e.format},on:{done:e.imageUploaded}})],1)],1),e.image?a("q-dialog",{model:{value:e.showImagePreviewDialog,callback:function(t){e.showImagePreviewDialog=t},expression:"showImagePreviewDialog"}},[a("q-card",{staticStyle:{width:"60vw"}},[a("q-bar",[e._v("\n        "+e._s(e.image?e.image.name:null)+"\n        "),a("q-space"),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",dense:"",icon:"mdi-close"}})],1),e.image?a("q-img",{attrs:{src:e.$img.src(e.image.image_id),srcset:e.$img.srcset(e.image),placeholder:e.image.placeholder}}):e._e()],1)],1):e._e()],1)},n=[],o=a("967e"),r=a.n(o),s=(a("96cf"),a("fa84")),l=a.n(s),c=a("7eb4"),d=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("q-table",{attrs:{flat:"",title:"Selecionar Imagen",data:e.data,columns:e.columns,"row-key":"image_id",pagination:e.pagination,filter:e.filter,loading:e.loading},on:{"update:pagination":function(t){e.pagination=t},request:e.request},scopedSlots:e._u([{key:"top-right",fn:function(){return[e._t("upload"),a("q-input",{attrs:{borderless:"",dense:"",debounce:"300",placeholder:"Buscar"},scopedSlots:e._u([{key:"append",fn:function(){return[a("q-icon",{attrs:{name:"mdi-magnify"}})]},proxy:!0}]),model:{value:e.filter,callback:function(t){e.filter=t},expression:"filter"}})]},proxy:!0},{key:"body-cell-preview",fn:function(t){return[a("q-td",{attrs:{props:t,"auto-width":""}},[a("q-avatar",{attrs:{rounded:"",color:"grey-4"}},[a("q-img",{attrs:{src:e.$img.src(t.row.image_id,"xs"),placeholder:t.row.placeholder}})],1)],1)]}},{key:"body-cell-select",fn:function(t){return[a("q-td",{attrs:{props:t}},[a("q-btn",{attrs:{flat:"",dense:"",icon:"mdi-check"},on:{click:function(a){return e.select(t.row)}}})],1)]}}],null,!0)})},m=[],u=a("02fa"),p=a.n(u),g=(a("7f7f"),a("bd4c")),f=g["b"].formatDate,h={name:"ImageSelect",props:{format:{type:String,required:!1,default:null}},data:function(){return{loading:!1,filter:"",data:[],pagination:{sortBy:null,descending:!1,page:1,rowsPerPage:5,rowsNumber:0},columns:[{name:"preview",label:"Previsualizar",align:"left"},{name:"name",field:"name",label:"Nombre",align:"left"},{name:"format",field:function(e){return e.format.name},label:"Formato",align:"left"},{name:"select",label:"Selecionar"}]}},methods:{formatDate:f,request:function(){var e=l()(r.a.mark(function e(){var t,a,i,n,o,s,l,c,d,m=arguments;return r.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=m.length>0&&void 0!==m[0]?m[0]:{},a=t.pagination,i=t.filter,n=void 0===i?"":i,a||(a=this.pagination),o="query ($where: website_image_bool_exp! $offset: Int! $limit: Int! $order_by: [website_image_order_by!]) {\n        meta: website_image_aggregate (where: $where) {\n          rows: aggregate {\n            count\n          }\n        }\n        data: website_image (where: $where offset: $offset limit: $limit order_by: $order_by) {\n          image_id\n          format_id\n          name\n          placeholder\n          format {\n            format_id\n            name\n            format_sizes {\n              size_id\n              width\n            }\n          }\n          created_at\n          created_by_user {\n            username\n          }\n        }\n      }",s={limit:a.rowsPerPage,offset:a.rowsPerPage*(a.page-1),order_by:[{created_at:"desc"}],where:{format_id:this.format?{_eq:this.format}:null,name:n?{_ilike:"%".concat(n,"%")}:null}},e.prev=4,this.loading=!0,e.next=8,this.$gql(o,s,{role:"administrator"});case 8:l=e.sent,c=l.data,d=l.meta.rows.count,this.pagination=p()({},a,{rowsNumber:d}),this.data=c,e.next=18;break;case 15:e.prev=15,e.t0=e["catch"](4),this.$gql.handleError(e.t0);case 18:return e.prev=18,this.loading=!1,e.finish(18);case 21:case"end":return e.stop()}},e,this,[[4,15,18,21]])}));function t(){return e.apply(this,arguments)}return t}(),select:function(e){this.$emit("done",e.image_id)}},mounted:function(){this.request()}},b=h,w=a("2877"),_=Object(w["a"])(b,d,m,!1,null,null,null),v=_.exports,q=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e.format?e._e():a("q-select",{attrs:{filled:"",label:"Formato",dense:"",options:e.formatOptions},model:{value:e.selectedFormat,callback:function(t){e.selectedFormat=t},expression:"selectedFormat"}}),a("q-uploader",{ref:"uploader",attrs:{disable:!e.uploadFormat,"auto-upload":"","with-credentials":"",label:"Aggregar Imagenes",bordered:"",flat:"",url:e.url,accept:".jpg, .png, image/*","field-name":"image",headers:e.headers},on:{uploaded:e.uploaded}})],1)},y=[],x={name:"ImageUpload",props:{format:{type:String,required:!1}},data:function(){return{selectedFormat:null}},computed:{formatOptions:function(){return this.$store.state.website.formats.map(function(e){var t=e.format_id,a=e.name;return{value:t,label:a}})},uploadFormat:function(){return this.format?this.format:this.selectedFormat?this.selectedFormat.value:null},url:function(){return"https://chuturubi.com/api/v1/upload/image?format=".concat(this.uploadFormat)},headers:function(){return[{name:"Authorization",value:"session-auth ".concat(this.$q.sessionStorage.getItem("session-auth"))}]}},methods:{uploaded:function(e){this.$emit("done",e.xhr.response)}}},$=x,I=Object(w["a"])($,q,y,!1,null,null,null),z=I.exports,D={name:"ImageInput",components:{DialogWindow:c["a"],ImageSelect:v,ImageUpload:z},props:{value:{type:String,required:!1},format:{type:String,required:!1}},data:function(){return{image:null,showImageSelectDialog:!1,showImageUploadDialog:!1,showImagePreviewDialog:!1}},watch:{value:function(){this.loadImage()}},methods:{loadImage:function(){var e=l()(r.a.mark(function e(){return r.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(!this.value){e.next=12;break}return e.prev=1,e.next=4,this.$store.dispatch("website/IMAGE",this.value);case 4:this.image=e.sent,e.next=10;break;case 7:e.prev=7,e.t0=e["catch"](1),this.$gql.handleError(e.t0);case 10:e.next=13;break;case 12:this.image=null;case 13:case"end":return e.stop()}},e,this,[[1,7]])}));function t(){return e.apply(this,arguments)}return t}(),imageUploaded:function(e){this.showImageSelectDialog=!1,this.showImageUploadDialog=!1,this.$emit("input",e)},imageSelected:function(e){this.showImageSelectDialog=!1,this.showImageUploadDialog=!1,this.$emit("input",e)}},mounted:function(){this.loadImage()}},k=D,S=Object(w["a"])(k,i,n,!1,null,null,null);t["a"]=S.exports},"7eb4":function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("q-dialog",{attrs:{value:e.value,maximized:e.maximized&&!e.minimized.state,persistent:"",seamless:e.minimized.state,position:e.minimized.state?"bottom":"standard","content-class":e.minimized.state?"dialog-window-minimized q-pa-none":null,"transition-hide":e.minimized.state?"slide-down":"scale"},on:{input:e.update,hide:e.reset}},[e.minimized.state?a("q-bar",{staticClass:"bg-primary text-white cursor-pointer rounded-borders overflow-hidden ellipsis",style:"width: 250px; margin-left: "+250*(null===e.minimized.slot?0:e.minimized.slot)+"px;",on:{click:e.restore}},[a("div",{staticClass:"ellipsis"},[e._v("\n      "+e._s(e.title)+"\n    ")]),a("q-space"),a("q-btn-group",{attrs:{flat:""}},[a("q-btn",{staticClass:"window-minimize",attrs:{flat:"",icon:"mdi-window-minimize",dense:"",disable:e.minimized.state}}),a("q-btn",{attrs:{flat:"",dense:"",icon:"mdi-window-"+(e.maximized?"maximize":"restore")}}),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",dense:"",icon:"mdi-close"},on:{click:function(e){e.stopPropagation(),e.preventDefault()}}})],1)],1):[a("div",{staticClass:"bg-white",style:e.maximized?"":"max-width: none; min-width: 560px"},[a("q-bar",{staticClass:"bg-primary text-white"},[a("div",{staticClass:"ellipsis"},[e._v("\n          "+e._s(e.title)+"\n        ")]),a("q-space"),a("q-btn",{staticClass:"window-minimize",attrs:{flat:"",dense:"",icon:"mdi-window-minimize"},on:{click:e.minimize}}),a("q-btn",{attrs:{flat:"",dense:"",icon:"mdi-window-"+(e.maximized?"restore":"maximize")},on:{click:e.toggle}}),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",dense:"",icon:"mdi-close"}})],1),a("main",{staticClass:"scroll",style:e.maximized?"max-height: calc(100vh - 32px);":"max-height: calc(100vh - 80px);"},[e._t("default")],2)],1)]],2)},n=[],o=(a("6762"),a("2fdb"),a("4db1")),r=a.n(o),s={name:"DialogWindow",props:{title:{type:String,default:""},value:{type:Boolean,required:!0}},data:function(){return{minimized:{state:!1,slots:[],slot:null},maximized:!1}},computed:{toggleIcon:function(){return this.minimized.state?this.maximized?"maximize":"restore":this.maximized?"restore":"maximize"},nextSlot:function(){var e=this;return Math.min.apply(Math,r()(this.minimized.slots.map(function(e,t){return t}).filter(function(t){return!e.minimized.slots.includes(t)})).concat([this.minimized.slots.length]))}},methods:{unbindSlot:function(){this.$root.$emit("DIALOG_WINDOW_RESTORED",this.minimized.slot),this.minimized.slot=null},bindSlot:function(){this.minimized.slot=this.nextSlot,this.$root.$emit("DIALOG_WINDOW_MINIMIZED",this.minimized.slot)},onBindSlot:function(e){this.minimized.slots.push(e)},onUnbindSlot:function(e){this.minimized.slots=this.minimized.slots.filter(function(t){return t!==e})},reset:function(){this.maximized=!1,this.minimizedId=0,null!==this.minimized.slot&&this.unbindSlot(),this.minimized.state=!1},minimize:function(){this.bindSlot(),this.minimized.state=!0},restore:function(){this.minimized.state=!1,this.unbindSlot()},toggle:function(){this.minimized.state?this.restore():this.maximized=!this.maximized},update:function(e){this.$emit("input",e)}},created:function(){this.$root.$on("DIALOG_WINDOW_MINIMIZED",this.onBindSlot),this.$root.$on("DIALOG_WINDOW_RESTORED",this.onUnbindSlot)},beforeDestroy:function(){null!==this.minimized.slot&&this.unbindSlot(),this.$root.$off("DIALOG_WINDOW_MINIMIZED",this.onBindSlot),this.$root.$off("DIALOG_WINDOW_RESTORED",this.onUnbindSlot)}},l=s,c=(a("5fa6"),a("2877")),d=Object(c["a"])(l,i,n,!1,null,null,null);t["a"]=d.exports},e916:function(e,t,a){t=e.exports=a("24fb")(!1),t.push([e.i,".q-btn.window-minimize .q-icon:before{margin-top:45%;height:45%}.q-dialog.dialog-window-minimized>.q-dialog__inner{justify-content:left}",""])}}]);