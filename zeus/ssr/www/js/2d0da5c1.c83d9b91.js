(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["2d0da5c1"],{"6aee":function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("q-page",{attrs:{padding:""}},[n("q-table",{attrs:{flat:"",title:e.client?"Facturas: "+e.client.name:"Facturas",data:e.table.data,columns:e.table.columns,"row-key":"invoice_id",pagination:e.table.pagination,filter:e.table.filter,loading:e.table.loading},on:{"update:pagination":function(t){return e.$set(e.table,"pagination",t)},request:e.loadInvoices},scopedSlots:e._u([{key:"top-right",fn:function(){return[n("q-input",{attrs:{borderless:"",dense:"",debounce:"300",placeholder:"Buscar"},scopedSlots:e._u([{key:"append",fn:function(){return[n("q-icon",{attrs:{name:"mdi-magnify"}})]},proxy:!0}]),model:{value:e.table.filter,callback:function(t){e.$set(e.table,"filter",t)},expression:"table.filter"}})]},proxy:!0},{key:"body-cell-izi_link",fn:function(t){return[n("q-td",{attrs:{props:t,"auto-width":""}},[n("q-btn",{attrs:{"no-wrap":"",flat:"",size:"sm",label:"Descargar","icon-right":"mdi-download",type:"a",href:t.row.izi_link,download:""}}),n("q-tooltip",[e._v("\n          Descargar Factura\n        ")])],1)]}},{key:"body-cell-client",fn:function(t){return[n("q-td",{attrs:{props:t,"auto-width":""}},[n("q-btn",{attrs:{"no-wrap":"",flat:"",size:"sm",label:"Cliente","icon-right":"mdi-open-in-new"},on:{click:function(n){return e.$router.push("/client/"+t.row.purchase.client_id)}}}),n("q-tooltip",[e._v("\n          Ver cliente\n        ")])],1)]}},{key:"body-cell-purchase",fn:function(t){return[n("q-td",{attrs:{props:t,"auto-width":""}},[n("q-btn",{attrs:{"no-wrap":"",flat:"",size:"sm",label:"Compra","icon-right":"mdi-open-in-new"},on:{click:function(n){return e.$router.push("/purchase/"+t.row.purchase_id)}}}),n("q-tooltip",[e._v("\n          Ver compra\n        ")])],1)]}},{key:"body-cell-details",fn:function(t){return[n("q-td",{attrs:{props:t,"auto-width":""}},[n("q-btn",{attrs:{"no-wrap":"",flat:"",size:"sm",label:"Detalles","icon-right":"mdi-open-in-new"},on:{click:function(n){return e.$router.push("/invoice/"+t.row.invoice_id)}}}),n("q-tooltip",[e._v("\n          Ver detalles de factura\n        ")])],1)]}}])}),n("q-inner-loading",{attrs:{showing:e.loading}},[n("q-spinner")],1)],1)},a=[],r=n("967e"),o=n.n(r),l=n("02fa"),c=n.n(l),s=(n("96cf"),n("fa84")),d=n.n(s),u=n("bd4c"),p=u["b"].formatDate,_={name:"Invoices",props:{purchaseId:{type:String,required:!1},clientId:{type:String,required:!1}},data:function(){return{loading:!1,client:null,table:{loading:!1,data:[],columns:[{name:"created_at",label:"Fecha Hora",align:"left",field:"created_at",format:function(e,t){return p(e,"YYYY/MM/DD HH:mm")}},{name:"izi_numero",label:"Numero",field:"izi_numero"},{name:"izi_comprador",label:"Comprador",field:"izi_comprador"},{name:"izi_razon_social",label:"Razon Social",field:"izi_razon_social"},{name:"izi_autorizacion",label:"Autorizacion",field:"izi_autorizacion"},{name:"izi_monto_total",label:"Monto Total",field:"izi_monto_total"},{name:"izi_control",label:"Control",field:"izi_control"},{name:"izi_link",label:"Descargar Factura"},{name:"client",label:"Ver cliente"},{name:"purchase",label:"Ver compra"},{name:"details",label:"Ver detalles"}],pagination:{sortBy:null,descending:!1,page:1,rowsPerPage:10,rowsNumber:0},filter:""}}},methods:{loadInvoices:function(){var e=d()(o.a.mark(function e(){var t,n,i,a,r,l,s,d,u,p=arguments;return o.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=p.length>0&&void 0!==p[0]?p[0]:{},n=t.pagination,i=t.filter,a=void 0===i?"":i,n||(n=this.table.pagination),r="query ($where: store_invoice_bool_exp! $offset: Int! $limit: Int! $order_by: [store_invoice_order_by!]) {\n        meta: store_invoice_aggregate (where: $where) {\n          rows: aggregate {\n            count\n          }\n        }\n        data: store_invoice (where: $where offset: $offset limit: $limit order_by: $order_by) {\n          invoice_id\n          created_at\n          purchase_id\n          purchase {\n            client_id\n          }\n          izi_link\n          izi_numero\n          izi_comprador\n          izi_razon_social\n          izi_autorizacion\n          izi_monto_total\n          izi_control\n        }\n      }",l={limit:n.rowsPerPage,offset:n.rowsPerPage*(n.page-1),order_by:[{created_at:"desc"}],where:{purchase:{client_id:this.clientId?{_eq:this.clientId}:null,purchase_id:this.purchaseId?{_eq:this.purchaseId}:null},_or:a?[{purchase:{client:{name:{_ilike:"%".concat(a,"%")}}}}]:[{}]}},e.prev=4,this.table.loading=!0,e.next=8,this.$gql(r,l,{role:"administrator"});case 8:s=e.sent,d=s.data,u=s.meta.rows.count,this.table.pagination=c()({},n,{rowsNumber:u}),this.table.data=d,e.next=18;break;case 15:e.prev=15,e.t0=e["catch"](4),this.$gql.handleError(e.t0);case 18:return e.prev=18,this.table.loading=!1,e.finish(18);case 21:case"end":return e.stop()}},e,this,[[4,15,18,21]])}));function t(){return e.apply(this,arguments)}return t}(),loadClient:function(){var e=d()(o.a.mark(function e(){var t,n,i,a;return o.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(this.clientId){e.next=2;break}return e.abrupt("return");case 2:return t="query ($client_id: uuid!) {\n        client: store_client_by_pk (client_id: $client_id) {\n          client_id\n          name\n        }\n      }",n={client_id:this.clientId},e.prev=4,this.loading=!0,e.next=8,this.$gql(t,n,{role:"administrator"});case 8:i=e.sent,a=i.client,this.client=a,e.next=16;break;case 13:e.prev=13,e.t0=e["catch"](4),this.$gql.handleError(e.t0);case 16:return e.prev=16,this.loading=!1,e.finish(16);case 19:case"end":return e.stop()}},e,this,[[4,13,16,19]])}));function t(){return e.apply(this,arguments)}return t}()},mounted:function(){this.loadClient(),this.loadInvoices()}},h=_,f=n("2877"),m=Object(f["a"])(h,i,a,!1,null,null,null);t["default"]=m.exports}}]);