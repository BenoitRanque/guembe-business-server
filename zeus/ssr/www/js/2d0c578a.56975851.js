(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["2d0c578a"],{"3edf":function(t,e,s){"use strict";s.r(e);var n=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("q-layout",{attrs:{view:"hHh Lpr lFf"}},[s("q-header",{attrs:{elevated:""}},[s("q-toolbar",{staticClass:"bg-white text-primary"},[s("q-btn",{attrs:{stretch:"",flat:"",dense:""},on:{click:function(e){return t.$router.push("/")}}},[s("q-avatar",{attrs:{rounded:""}},[s("img",{attrs:{src:"statics/icons/icon-256x256.png"}})])],1),s("q-separator",{attrs:{vertical:"",inset:""}}),s("q-btn",{attrs:{flat:"",dense:"",stretch:"",icon:"mdi-menu"},on:{click:function(e){t.showLeftDrawer=!t.showLeftDrawer}}}),s("q-separator",{attrs:{vertical:"",inset:""}}),s("q-toolbar-title",[t._v("\n        Biocentro Guembe "+t._s(t.$route.path)+"\n      ")]),s("q-separator",{attrs:{vertical:"",inset:""}}),t.isAuthenticated?[s("q-btn-dropdown",{attrs:{flat:"",stretch:"","auto-close":"",label:"Mi Cuenta"},model:{value:t.showUserSessionDropdown,callback:function(e){t.showUserSessionDropdown=e},expression:"showUserSessionDropdown"}},[s("q-list",[s("q-item",{attrs:{clickable:""},on:{click:function(e){return t.$store.commit("website/LOCALE","es"===t.$store.state.website.locale?"en":"es")}}},[s("q-item-section",{attrs:{side:""}},[s("q-icon",{attrs:{name:"mdi-flag"}})],1),s("q-item-section",[t._v("\n                Cambiar Idioma "+t._s(t.$store.state.website.locale)+"\n              ")])],1),s("q-item",{attrs:{clickable:""},on:{click:function(e){t.showUserPasswordDialog=!0}}},[s("q-item-section",{attrs:{side:""}},[s("q-icon",{attrs:{name:"mdi-lock-reset"}})],1),s("q-item-section",[t._v("\n                Cambiar Contraseña\n              ")])],1),s("q-separator"),s("q-item",{attrs:{clickable:""},on:{click:t.logout}},[s("q-item-section",{attrs:{side:""}},[s("q-icon",{attrs:{name:"mdi-logout"}})],1),s("q-item-section",[t._v("\n                Cerrar Session\n              ")])],1)],1)],1)]:[s("q-btn-dropdown",{attrs:{flat:"",stretch:"",label:"Iniciar Session"},model:{value:t.showLoginDropdown,callback:function(e){t.showLoginDropdown=e},expression:"showLoginDropdown"}},[s("user-authentication")],1)]],2)],1),s("q-drawer",{attrs:{bordered:"","content-class":"bg-grey-2"},model:{value:t.showLeftDrawer,callback:function(e){t.showLeftDrawer=e},expression:"showLeftDrawer"}},[s("q-list",[s("q-item-label",{attrs:{header:""}},[t._v("Menu principal")]),s("q-item",{attrs:{to:"/holidays"}},[s("q-item-section",[s("q-item-label",[t._v("\n            Feriados\n          ")])],1)],1),s("q-item",{attrs:{to:"/lifetimes"}},[s("q-item-section",[s("q-item-label",[t._v("\n            Vigencias\n          ")])],1)],1),s("q-item",{attrs:{to:"/products"}},[s("q-item-section",[s("q-item-label",[t._v("\n            Productos\n          ")])],1)],1),s("q-item",{attrs:{to:"/listings"}},[s("q-item-section",[s("q-item-label",[t._v("\n            Paquetes\n          ")])],1)],1),s("q-item",{attrs:{to:"/invoices"}},[s("q-item-section",[s("q-item-label",[t._v("\n            Facturas\n          ")])],1)],1),s("q-item",{attrs:{to:"/purchases"}},[s("q-item-section",[s("q-item-label",[t._v("\n            Compras\n          ")])],1)],1),s("q-item",{attrs:{to:"/clients"}},[s("q-item-section",[s("q-item-label",[t._v("\n            Clientes\n          ")])],1)],1),s("q-item",{attrs:{to:"/purchasedproducts",exact:""}},[s("q-item-section",[s("q-item-label",[t._v("\n            Productos Comprados\n          ")])],1)],1),s("q-item",{attrs:{to:"/purchasedproducts/use"}},[s("q-item-section",[s("q-item-label",[t._v("\n            Uso de productos Comprados\n          ")])],1)],1),s("q-item",{attrs:{to:"/website"}},[s("q-item-section",[s("q-item-label",[t._v("\n            Sitio Web\n          ")])],1)],1)],1)],1),s("router-view",{attrs:{name:"background"}}),s("q-page-container",[s("router-view")],1),s("q-dialog",{model:{value:t.showLoginDialog,callback:function(e){t.showLoginDialog=e},expression:"showLoginDialog"}},[s("user-authentication")],1),s("q-dialog",{model:{value:t.showUserPasswordDialog,callback:function(e){t.showUserPasswordDialog=e},expression:"showUserPasswordDialog"}},[s("user-password")],1)],1)},a=[],o=s("967e"),r=s.n(o),i=(s("96cf"),s("fa84")),c=s.n(i),l=s("02fa"),u=s.n(l),d=s("2f62"),p=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("q-card",[s("q-form",[s("q-card-section",[s("div",{staticClass:"text-h6 text-center"},[t._v("\n        Bienvenido\n      ")]),s("div",{staticClass:"text-subtitle2 text-center"},[t._v("\n        Por favor inicia session\n      ")])]),s("q-card-section",[s("q-input",{staticClass:"q-mb-sm",attrs:{dense:"",autocomplete:"username",outlined:"",label:"Nombre De Usuario"},model:{value:t.username,callback:function(e){t.username=e},expression:"username"}}),s("q-input",{attrs:{dense:"",autocomplete:"current-password",outlined:"",label:"Contraseña",type:"password"},model:{value:t.password,callback:function(e){t.password=e},expression:"password"}})],1),s("q-separator"),s("q-card-actions",{attrs:{align:"center"}},[s("q-btn",{attrs:{flat:"",color:"accent",type:"submit",icon:"mdi-login",label:"Iniciar Session",disable:t.invalidInput},on:{click:t.login}})],1),s("q-inner-loading",{attrs:{showing:t.loading}},[s("q-spinner")],1)],1)],1)},m=[],h={name:"UserAuthentication",data:function(){return{loading:!1,username:"",password:""}},computed:{invalidInput:function(){return!this.username.length}},methods:u()({},Object(d["b"])(["LOGIN"]),{login:function(){var t=c()(r.a.mark(function t(){return r.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,this.loading=!0,t.next=4,this.LOGIN({username:this.username,password:this.password});case 4:this.$q.notify({icon:"mdi-check",color:"positive",message:"Session Iniciada"}),this.$emit("done"),t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](0),this.$gql.handleError(t.t0);case 11:return t.prev=11,this.loading=!1,t.finish(11);case 14:case"end":return t.stop()}},t,this,[[0,8,11,14]])}));function e(){return t.apply(this,arguments)}return e}()})},w=h,q=s("2877"),f=Object(q["a"])(w,p,m,!1,null,null,null),b=f.exports,v=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("q-card",[s("q-bar",[t._v("\n    Cambiar contraseña\n    "),s("q-space"),s("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",dense:"",icon:"mdi-close"}})],1),s("q-form",[s("q-card-section",[s("div",{staticClass:"text-subtitle2 text-center"},[t._v("\n        Su contraseña debe tener un minimo de 12 carácteres\n      ")])]),s("q-card-section",[s("q-input",{staticClass:"q-mb-sm",attrs:{autocomplete:"new-password",dense:"",outlined:"",label:"Contraseña Nueva",type:"password"},model:{value:t.password1,callback:function(e){t.password1=e},expression:"password1"}}),s("q-input",{attrs:{autocomplete:"new-password",dense:"",outlined:"",label:"Contraseña Nueva (otra vez)",type:"password"},model:{value:t.password2,callback:function(e){t.password2=e},expression:"password2"}})],1),s("q-separator"),s("q-card-actions",{attrs:{align:"center"}},[s("q-btn",{attrs:{icon:"mdi-lock-reset",flat:"",type:"submit",color:"accent",disable:!t.validInput},on:{click:t.updatedPasword}},[t._v("Cambiar Contraseña")])],1),s("q-inner-loading",{attrs:{showing:t.loading}},[s("q-spinner")],1)],1)],1)},g=[],_={name:"UserPassword",data:function(){return{password1:"",password2:"",loading:!1}},computed:u()({},Object(d["c"])(["userId"]),{validInput:function(){return this.password1.length>=12&&this.password1===this.password2}}),methods:{updatedPasword:function(){var t=c()(r.a.mark(function t(){var e,s,n,a;return r.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return e="mutation ($password: String! $user_id: uuid!) {\n        user: update_staff_user (where: {\n          user_id: {\n            _eq: $user_id\n          }\n        } _set: {\n          password: $password\n        }) {\n          updated: affected_rows\n        }\n      }",s={password:this.password1,user_id:this.userId},t.prev=2,this.loading=!0,t.next=6,this.$gql(e,s,{role:"user"});case 6:n=t.sent,a=n.user.updated,a?this.$q.notify({color:"positive",icon:"mdi-check",message:"Contraseña modificada exisosamente. Podra utilizarla en su proximo inicio de session"}):this.$q.notify({color:"negative",icon:"mdi-alert",message:"Error modificando contraseña"}),t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](2),this.$gql.handleError(t.t0);case 14:return t.prev=14,this.loading=!1,t.finish(14);case 17:case"end":return t.stop()}},t,this,[[2,11,14,17]])}));function e(){return t.apply(this,arguments)}return e}()}},k=_,x=Object(q["a"])(k,v,g,!1,null,null,null),D=x.exports,C={name:"UserLayout",components:{UserAuthentication:b,UserPassword:D},data:function(){return{showLeftDrawer:!1,showLoginDialog:!1,showUserPasswordDialog:!1,showLoginDropdown:!1,showUserSessionDropdown:!1}},watch:{isAuthenticated:function(){this.showLoginDropdown=!1,this.showUserSessionDropdown=!1}},computed:u()({},Object(d["c"])(["isAuthenticated"])),methods:u()({},Object(d["b"])({storeLogout:"LOGOUT"}),{logout:function(){var t=c()(r.a.mark(function t(){return r.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.storeLogout();case 3:this.$router.push("/"),t.next=9;break;case 6:t.prev=6,t.t0=t["catch"](0),this.$api.handleError(t.t0);case 9:case"end":return t.stop()}},t,this,[[0,6]])}));function e(){return t.apply(this,arguments)}return e}(),authenticationRequested:function(){this.showLoginDialog=!0}}),created:function(){this.$root.$on("AUTHENTICATION_REQUIRED",this.authenticationRequested)},beforeDestroy:function(){this.$root.$off("AUTHENTICATION_REQUIRED",this.authenticationRequested)}},L=C,$=Object(q["a"])(L,n,a,!1,null,null,null);e["default"]=$.exports}}]);